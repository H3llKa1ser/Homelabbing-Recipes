# Splunk SIEM

## VM Specs

    OS: Ubuntu Linux
    RAM: 4096 MB (4GB)
    CPU: 1
    Disk Space: 100GB
    Skip Unattended Installation: Yes
    Network Adapter: Internal Network (LabLAN4 AKA SECURITY INTERFACE)

### 1) Ubuntu Installation

After following the instructions for installing Ubuntu, install the VBox Guest Additions by inserting the disk by clicking on:

    Devices -> Insert Drive with Guest Additions

Click on the disk, right click anywhere within the file explorer and choose, Open in Terminal.

Run the command:

    sudo ./VBoxLinuxAdditions.run

Then

    sudo reboot

Install Updates

    sudo apt update && sudo apt full-upgrade

### 2) Splunk Installation

To install Splunk, you either have to create an account on https://www.splunk.com/en_us/download/splunk-enterprise.html to use the latest version,

OR

Download the .deb file from this link

    wget https://download.splunk.com/products/splunk/releases/9.1.2/linux/splunk-9.1.2-b6b9c8185839-linux-2.6-amd64.deb

Install cURL Splunk dependency

    sudo apt install curl

Install Splunk (If you have a different version, the filename might be different so use the filename you downloaded instead.)

    sudo dpkg -i splunk-9.1.2-b6b9c8185839-linux-2.6-amd64.deb

After the installation is completed use the following command to launch Splunk:

    sudo /opt/splunk/bin/splunk start --accept-license --answer-yes

Provide a name and password when prompted. These credentials need to be used to log into Splunk.

Once the setup is complete we see the Splunk is running on 

    http://127.0.0.1:8000

Run the following to allow Splunk to start automatically when the system is booted. (Optional)

    sudo /opt/splunk/bin/splunk enable boot-start

### 3) Splunk Configuration

Browse to 

    http://127.0.0.1:8000

and enter your admin credentials you used upon installing Splunk.

Then go to:

    Settings -> Forwarding and Receiving

<img width="1841" height="868" alt="image" src="https://github.com/user-attachments/assets/ed0bc376-e6cd-4f45-b1e4-9dd7d1bede37" />

In the "Receive data" section, click "Add new"

<img width="1831" height="467" alt="image" src="https://github.com/user-attachments/assets/c96116d0-fe67-49fd-a998-955b882d3847" />

In the text input, write 9997 for the Splunk server to listen on TCP port 9997 to receive data. then click Save

### 4) Universal Forwarder (Splunk Agent)

#### Windows

Download link: https://download.splunk.com/products/universalforwarder/releases/9.1.2/windows/splunkforwarder-9.1.2-b6b9c8185839-x64-release.msi

Double-click on the .msi file to begin installation and follow the steps:

1) Check the License Agreement box

2) Provide a username and password for the Forwarder (TIP: Use the same credentials as you used for your central Splunk server)

3) On Deployment server, enter the central Splunk server IP with port 8089. You can get the IP of your Splunk server in Ubuntu with the command:

        ip a

4) Again, enter the Splunk server IP with port 9997.

5) Install, then Finish.

### 5) Data Ingestion Configuration

Now that we have Splunk and Universal Forwarder configured we need to link both the pieces together so that Splunk can collect data.

In Splunk, select

    Settings -> Add Data -> Forward

Our DC VM should automatically show up in the left box. Click on “add all” to move it to the right side. In the “New Source Class Name” field provide a name for the source. Click on Next to continue.

Select “Local Event Logs” then click on the “add all” button above the dropdown field to ingest all the logs generated by the DC. Click on Next once done.

Click on “Create a new index“.Indexes are the Splunk equivalent of SQL Tables. It is used to store similar data.

Provide the Index a name. Keep all the other fields on their default value and click on Save then click on Next.

Confirm all the options look correct and click on Submit.

### 6) Query the Data

From Splunk, select

    Apps -> Search & Reporting

In the search box, type:

    index="windows" (or any other name provided in the previous step)

#### TIP: If the search does not return any value, wait for 2-3 minutes and then try again. If there is still no data go to the Windows VM and perform some simple actions (open applications, change settings, etc.) then after sometime you should see data flowing into Splunk.

